version: '3.7'

services:
  # Web
  traefik:
    container_name: ${COMPOSE_PROJECT_NAME}_traefik
    build:
      context: ./traefik
      args:
        - TRAEFIK_VERSION=${TRAEFIK_VERSION}
    command: --debug=${TRAEFIK_DEBUG} --logLevel=${TRAEFIK_LOG_LEVEL}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./traefik/traefik.toml:/etc/traefik/traefik.toml
      - ./traefik/ssl/certs:/ssl/certs
      - ./traefik/ssl/private:/ssl/private
#      - ./traefik/acme.json:/etc/traefik/acme.json
    ports:
      - 80:80
      - 443:443
      - 14500:14500
    labels:
      - "traefik.backend=${COMPOSE_PROJECT_NAME}.traefik"
      - "traefik.frontend.rule=Host:${COMPOSE_PROJECT_NAME}.traefik.docker"
      - "traefik.port=8080"
      - "traefik.frontend.passHostHeader=true"

networks:
  default:
    external:
      name: traefik
